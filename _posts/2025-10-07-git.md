---
layout: post
title: Git
---

# Table of Contents
- [tldr](#tldr)
- [What is Git?](#what-is-git)
- [What is GitHub?](#github)
- [Install Git](#install-git)
- [Git config](#git-config)
- [.gitignore](#gitignore)
- [What is a git repository?](#git-repository)
- [Create a repository](#create-a-repository)
- [Basic workflow](#basic-workflow)
- [Git Log](#git-log)
- [States of files](#file-states)
- [Git project areas](#git-project-areas)
- [Git basics, behind the scenes](#behind-the-scenes)
- [Need for staging](#need-for-staging)
- [Remote]
- [Branching]
- [Merging]
- [Merge conflict]
- [Rebase]
- [Cherrypick](#cherry-pick)
- [git init inside a repo]
- [Inside the .git directort]


## tldr

Git is a Distributed Version Control System written by Linus Torvalds in 2005.

Git is a software whereas Github, GitLab etc. are host git service.

Check git version
```
git --version
git -v
```

Two days to create a repository. 
- Convert a local dir into a git repository
- Clone an existing repository from somewhere.

A file in a git repository can be in three states: 
- modified
- staged
- comitted

There are three areas of git project: 
- Working Directory
- Staging Area (Index)
- Local repository

Git config to set on a new system before git init or git clone.
```
git config --global user.name "John Doe"
git config --global user.email johndoe@example.com
git config --global core.editor emacs
git config --global init.defaultBranch main
git config --list
```

.gitignore - Create this file in our repository. 
Add a list of files and directory you want git to ignore.

Git basic workflow:
```
- vi filename
- git add filename
- git commit -m "add filename"
- git push 
```

To check the status of files in the repository.
```
git status
``` 

Check git history
```
git log
git log --oneline
```

Check current branch
```
git branch
```

Create new branch
```
git branch branch_name
```

Switch to different branch
```
git checkout branch_name
git switch branch
```

Create new branch and switch to it
```
git checkout -b branch_name
git switch -c branch_name
```

Merge a branch to main
```
git checkout -b feature
make changes
stage and commit
git checkout main
git merge feature
```

Clone a repository
```
git clone URL
```

This creates the directory, initilizes it and files in the repository are checked out to the working dir 

Pair an existing local repository with remote and push it
```
git remote add origin URL
git push -u origin main
```

Diff between commit
```
git diff 9686bb8 e6de8d6
```

Diff between branch
```
git diff master..footer
```

## What is Git
Git a distributed version control system(DCVS). It was written by Linus Torvalds, the creator of Linux in 2005. But why did Linus took time to create it?

From the [Git website](https://git-scm.com/book/en/v2/Getting-Started-A-Short-History-of-Git):
>During the early years of the Linux kernel maintenance (1991–2002), changes to the software were passed around as patches and archived files. In 2002, the Linux kernel project began using a proprietary DVCS called BitKeeper.
>
>In 2005, the relationship between the community that developed the Linux kernel and the commercial company that developed BitKeeper broke down, and the tool’s free-of-charge status was revoked. This prompted the Linux development community (and in particular Linus Torvalds, the creator of Linux) to develop their own tool based on some of the lessons they learned while using BitKeeper.

As a distributed VCS:
- Every developer has full repo   
- Commits & branches locally      
- Merge/push to remote later 


### A list of major SCM/VCS softwares:

| SCM / VCS           | Type                 | Years Active          | Notes |
|---------------------|--------------------|---------------------|-------|
| **RCS**             | Centralized         | 1982 – present      | Early file-based version control, mainly for single files. |
| **CVS**             | Centralized         | 1986 – 2000s        | Popular for open-source projects; weak branching support. |
| **Perforce**        | Centralized         | 1995 – present      | High-performance, enterprise-grade, handles large repos. |
| **Subversion (SVN)**| Centralized         | 2000 – present      | Replaced CVS in many places; better branching and atomic commits. |
| **BitKeeper**       | Distributed (DVCS)  | 1998 – 2005 (Linux kernel) | Proprietary; early DVCS used by Linux kernel before Git. |
| **Monotone**        | Distributed (DVCS)  | 2003 – present      | Open-source DVCS; cryptographic commits; limited adoption. |
| **Git**             | Distributed (DVCS)  | 2005 – present      | Created by Linus Torvalds; fast, distributed, excellent branching. |
| **Mercurial**       | Distributed (DVCS)  | 2005 – present      | Similar to Git; simpler CLI; used by some large projects. |


## GitHub
Git is a software. [GitHub](https://github.com/) is a Microsoft owned hosted git repository. It is a cloud bsaed service based on git. There are similar other services such as: 
- GitLab
- Bitbucket
- Azure Repos
- AWS CodeCommit
- Gitea (self-hosted)
- Gerrit (self-hosted)

## Install Git
For Debian based distro such as Ubuntu:

```
sudo apt install git  -y
git --version
git version 2.34.1
```

Google it for other distro or OS. 

## Git config
If you are setting up git for the first time on your system, perform the following configuration.

Setup your identity. This is used by git in your commit log to record who performs the changes.
```
git config --global user.name "John Doe"
git config --global user.email johndoe@example.com
```

Configure your preferred editor. Git will open this when it needs you to type a message. The default is vim.
```
git config --global core.editor emacs
```

For every new repository, by default git creates a branch called master. The one considered more politically correct is called main. To change the default branch name:
``` 
git config --global init.defaultBranch main
```

Show the config
```
git config --list
user.name=John Doe
user.email=johndoe@example.com
core.editor=emacs
init.defaultbranch=main
```

Where are these stored?
```
cat ~/.gitconfig
[user]
	name = John Doe
	email = johndoe@example.com
[core]
	editor = emacs
[init]
	defaultBranch = main
```

### Why use `--global`?
We use the `--global` flag to use the config for all projects. If you need, you can configure a per project config by running the same commands  without the --global flag.

Example:
```
cd project
git config --global user.name "JD"
```

The commit log on this repository will use JD instead of John Doe. 

## Gitignore
There may be some files and dirs in your profect you do not want or need git to track. To instruct git to ignore these, create a .gitignore file and populate it with the list of files and dirs.

Example: 
```
cd project
mkdir secret
touch file1 file2 secret/file3
```

Git tells me all of these are untracked.
```
git status
On branch main

No commits yet

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	file1
	file2
	secret/
```

To stop git from tracking file and secret dir:
```
vi .gitignore
cat .gitignore
file1
secret/
```

Git stops tracking them:
```
git status
On branch main

No commits yet

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	.gitignore
	file2

nothing added to commit but untracked files present (use "git add" to track)
```

Depending on the type of your project, there may be many files you do not need to track and you may not know them all. You can use .gitignore generators to generate a .gitignore file. Google ".gitignore generator"

## Git repository
A git repository is a directory tracked by git for changes.

This is a git repository:
```
git status
On branch main

No commits yet

nothing to commit (create/copy files and use "git add" to track)

ls -la
total 12
drwxrwxr-x 3 vagrant vagrant 4096 Oct  7 17:20 .
drwxr-x--- 8 vagrant vagrant 4096 Oct  7 17:19 ..
drwxrwxr-x 7 vagrant vagrant 4096 Oct  7 17:20 .git
```

This is not a git repository:
```
git status
fatal: not a git repository (or any of the parent directories): .git

ls -la
total 8
drwxrwxr-x 2 vagrant vagrant 4096 Oct  7 17:19 .
drwxr-x--- 8 vagrant vagrant 4096 Oct  7 17:19 ..
```

## Create a repository
There are two ways to create a git repository
- Take a local dir and convert it into a Git repository
- Clone a Git repository from somewhere

### Convert local dir into a Git repository
```
#Go to the directory
cd project

#Check if it's a repository already
git status
fatal: not a git repository (or any of the parent directories): .git

#Initialize the directory
git init
Initialized empty Git repository in /home/vagrant/newdir/.git/

#This is now a git repository
#Note the presence of the hidden .git dir
ls -la
total 12
drwxrwxr-x  3 vagrant vagrant 4096 Oct  7 17:50 .
drwxr-x--- 10 vagrant vagrant 4096 Oct  7 17:49 ..
drwxrwxr-x  7 vagrant vagrant 4096 Oct  7 17:50 .git
```
### Clone a git repository from somewhere
```
#git clone <URL>
git clone https://github.com/libgit2/libgit2
Cloning into 'libgit2'...
remote: Enumerating objects: 129408, done.
remote: Counting objects: 100% (129408/129408), done.
remote: Compressing objects: 100% (35355/35355), done.
remote: Total 129408 (delta 91950), reused 129397 (delta 91942), pack-reused 0 (from 0)
Receiving objects: 100% (129408/129408), 70.45 MiB | 9.10 MiB/s, done.
Resolving deltas: 100% (91950/91950), done.

#Go into the libgit2 directory
cd libgit2/
git status
On branch main
Your branch is up to date with 'origin/main'.

nothing to commit, working tree clean

#List the dir
ls -la
total 208
drwxrwxr-x 16 vagrant vagrant  4096 Oct  7 17:55 .
drwxr-x--- 11 vagrant vagrant  4096 Oct  7 17:55 ..
-rw-rw-r--  1 vagrant vagrant   267 Oct  7 17:55 api.docurium
-rw-rw-r--  1 vagrant vagrant  1328 Oct  7 17:55 AUTHORS
drwxrwxr-x  3 vagrant vagrant  4096 Oct  7 17:55 ci
-rw-rw-r--  1 vagrant vagrant  2741 Oct  7 17:55 .clang-format
drwxrwxr-x  2 vagrant vagrant  4096 Oct  7 17:55 cmake
-rw-rw-r--  1 vagrant vagrant  6232 Oct  7 17:55 CMakeLists.txt
-rw-rw-r--  1 vagrant vagrant 64631 Oct  7 17:55 COPYING
drwxrwxr-x  8 vagrant vagrant  4096 Oct  7 17:55 deps
...
```
Cloning is a way to get a copy of an existing repository. The following happens when we clone libgit2 from https://github.com/libgit2/libgit2:
- It creates the directory libgit2
- It initializes the .git directory inside it
- It pulls down all the data from that repository
- It checks out the files into your working area



