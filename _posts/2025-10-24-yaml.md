---
layout: post
title: YAML
---
YAML (pronounced "yaamel") is a human-readable and human-friendly language for data serialization. It is commonly used for configuration files, infrastructure, infrastructure automation and data serialization.   

# Table of Contents
- [Data Serialization](#data-serialization)
- [Why learn YAML?](#why-learn-yaml)
- [Key points](#key-points)
- [Learning resources](#learning-resources)
- [Validator, linter](#validator-linter)
- [Comment](#comment)
- [Data types](#data-types)
- [Scalar](#scalar)
- [Sequence](#sequence)
- [Mapping](#mapping)
- [Nesting](#nesting)
- [Document](#document)
- [Multi-line strings](#multi-line-strings)
- [Anchor, Alias](#anchor-alias)
- [Flow type](#flow-type)
- [Update YAML file with yq](#update-yaml-file-with-yq)
- [Learn YAML from it's site](#learn-yaml-from-its-site)

## Data Serialization
All documents on YAML that I referred introduces it as a data serialization language but none of them explains what is serialization. Except [this](https://www.freecodecamp.org/news/what-is-yaml-the-yml-file-format/).

Someone from a dev background would understand it though I bet most of them won't be able to explain it in a simple language. If you are someone like me with little to no dev background (I can code a bit but I've no experience), you may be left wondering what the hell is it. 

I worked for Cohesity where the product uses Protobuf for data serialization. I have now figured they use Protobuf because it is small and fast as it's in binary format. While I was there, I asked a dev, "What is a proto". He told a proto is a serialized object. This is technically correct but practically useless explanation to someone new to the concept.   

As creators on YouTube explainer videos often say, let me explain.

- One of the most common explanations is
    >Serialization is the process of converting a data structure or object into a format that can be easily stored, transmitted
- Lets simplify this. A computer stores data in memory, say information about a person([Nicely explained here](https://medium.com/@khemanta/data-serialization-and-deserialization-what-is-it-29b5ca7a756f)). We want to store this for future retrieval or transfer it to another computer. How do we achieve it?
- The solution is to write it to a file. We can open the file later for reading or send it to another computer. But would the program on the receiving end understand the file? A simple data about a person may not be problem but real world data would a lot more complex. We need a format or a structure that both ends can understand. 
- This is where data serialization language comes it. So a data serialization language is a language to save the data from the memory so it can be stored and transferred over the network. 
- It is a language to format data such that programs can exchange data between them. 
- It is a language for storing and transferring data.
- It can be a text file which is human-readable or binary file which is not human-readable.
- The reverse of this process is called deserialization. Reading data from a file into the memory that programs can understand.
- It is also called marshalling and marshalling thought it may different slightly.  
- I love these comments on this Reddit [thread](https://www.reddit.com/r/learnprogramming/comments/ydhn09/can_someone_please_explain_what_serialization_is/).
    > It's just putting data into a file lol. 
    > An MP3 is a non-text serialization of audio data 
- Why the word serialize? Serialize means to convert to a series. Data in the memory is often not stored serially or contiguously. When saved to a file, it is converted into a structured continuous line of stream of bytes. Hence, series and serialize. 
- The common serialization languages in use today are:
    - Human-readable/Text format: XML, JSON and YAML
    - Human-unreadable/binary format: Protobuf, Pickle, Avro
- There are many more: [Comparison of data-serialization formats](https://en.wikipedia.org/wiki/Comparison_of_data-serialization_formats).

Summary:

| Process | Description | Common Use Case |
| :--- | :--- | :--- |
| **Serialization** (Encoding/Marshalling) | Converting the in-memory object structure into a stream of bytes or a text format. | Sending data from a web server to a browser. |
| **Deserialization** (Decoding/Unmarshalling) | Recreating the original object structure from the serialized stream of bytes or text. | A browser receiving JSON data and turning it back into a JavaScript object. |

## Why learn YAML
Ansible playbook uses YAML. Kubernetes manifest uses YAML. Docker Compose uses YAML. 

If you are going to learn and use these tools, you are going to deal with YAML. While you can learn YAML on the go, others may prefer to at least scratch the surface and acquire some foundational knowledge on YAML. 

Besides, while it seems simple enough, I found myself getting confused on some situations. I tried learning on the go and here I am. Back to learn, for a firm grip on the basics.  

## Key points
- YAML is a language for data serialization.
- It was [originally called](https://yaml.org/spec/history/2001-08-01.html) Yet Another Markup Language, later [changed](https://yaml.org/spec/history/2002-04-07.html) to YAML Ain't Markup Language.
- The official website is [yaml.org](https://yaml.org/)
- The latest revision is [1.2.2](https://yaml.org/spec/1.2.2/)
- The creators are Clark Evans, Oren Ben-Kiki, and Ingy d√∂t.
- The preferred file extension is .yaml but .yml is also widely used.
- Tab is not allowed for indentation. The preferred indentation is two spaces.
- It supports three data types: scalar, mapping and sequence.
- YAML is quite [similar](https://yaml.org/spec/1.2.2/#chapter-1-introduction-to-yaml) to JSON, by coincidence.
- YAML 1.2 is a [strict superset](https://yaml.org/spec/1.2.2/#chapter-1-introduction-to-yaml) of JSON. Try pasting a JSON file to an [YAML validator](#https://www.yamllint.com/).
- A YAML file can contain multiple documents. If a file has more than one document, separate them with `---` marker.


## Learning resources
- [Learn X in Y minutes](https://learnxinyminutes.com/yaml/) for a quick walk through
- [yaml.info](https://www.yaml.info/index.html) to get a good grasp for the foundation 
- [YAML Specification](#https://yaml.org/spec/1.2.2/) The source of truth. Read the introduction and vverview. Beyond that, may be use it as a reference. 
- [freeCodeCamp article](https://www.freecodecamp.org/news/what-is-yaml-the-yml-file-format/) One of the few resources that attempts to explain data serialization.

## Validator, linter
Linter is a new term for me. This is the joy of learning. Besides the topic of what you currently learn, you learn something else along the way. 

Validator checks the syntax and rules of the language. Linter goes beyond validator. 

- [yamllint.com](https://www.yamllint.com/) Web based YAML linter
- yamllint Command line YAML linter
- If you use VS Code, install the plugin [YAML Language Support by Red Hat](https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml)

## Comment
YAML uses # for commenting. It does not have a separate way for multi-line comment. Every line of comment should start with #.

```
# This is a sequence
# It is a list of job roles
- DevOps
- DevSecOps
- MLOps
```


## Data types
YAML has three data types:
1. Scalar
2. Sequence 
3. Mapping

Scalar is atomic data type such as strings, numbers, boolean etc. that cannot be broken down further without losing its meaning.

Sequence is an ordered list of scalar, mapping or even sequence.

Mapping is an unordered set of key/value pairs. Each key should ve unique.

One of the goals of YAML is be portable between languages. Therefore, it uses language independent terms like sequence and mapping, instead of list/array and dictionary/hash, so it avoids tying the concept to any particular language's implementation.

## Scalar
Atomic data types like strings, numbers, booleans and null which cannot further broken down.

Unlike JSON, strings need not be placed within quotes. One example where you would want to place it within quotes is the usage of yes and no. If they are not within quotes, they are treated as boolean, evaluating to true or false.

A blank space, the word _null_ or ~ represent null value. 

```
- 
- 
- 
```
This would be treated
```
- null
- null
- null
```
## Sequence
This is a sequence of scalars. Each iterm starts with a hyphen and a space.
```
- DevOps
- DevSecOps
- MLOps
```
We can have sequence of sequence or sequence of mapping. We will cover that in the nesting section.

## Mapping
Mapping is in the form key: value. The key and value are separated by a colon and a space. 

```
year: 2025
month: October
day: Friday
date: 24
```

This is a simple mapping where each value is a scalar. The value can be a sequence or another mapping. We will cover that in the next section.

The key value pair should be on the same line. This is not valid.
```
year:
2025
```

The key doesn't have to be string.
```
3.14: The value of PI
```

Check out the examples of complex keys [here](https://learnxinyminutes.com/yaml/).

## Nesting
Mapping of mapping.
This is an address. 
```
address: 1 MG Road, Bangalore, Karnataka 560008,Opposite Vivanta by Taj
```

It is very difficult to read. We can restructure it by nesting.
```
address:
  street: 1 MG Road
  city: Bangalore
  state: Karnataka
  pin: 560008
  landmark: Opposite Vivanta by Taj
````
The top key is address whose value is a group of other mappings.

When the value is not a scalar, the value should start at the next line and it should be indented.

Next, lets nest a sequence in a mapping.

```
job_roles:
  - DevOps
  - DevSecOps
  - MLOPs
```

This is also valid.
```
job_roles:
- DevOps
- DevSecOps
- MLOPs
```

Hyphen is considered an indent.

Lets expand our job roles and create of list of job roles where each item is also a list.

```
job_roles:
  - - DevOps
    - DevSecOps
    - MLOPs
  - - Full stack Dev
    - Frontend Dev
    - Backend Dev
  - - Project Manager
    - Business Analyst
    - Program Manager
```
For each item, the content is another sequence. It is allowed to started writing on the same line. 

Lets represent 1MG mall in YAML with its address and list of shops available.
```
1MG:
  address:
  street: 1 MG Road
  city: Bangalore
  state: Karnataka
  pin: 560008
  landmark: Opposite Vivanta by Taj
  Shops:
    - Hamleys
    - H&M
    - Marks & Spencer
    - AND
    - Hidesign
    - Aldo
    - Clark's
```
The brands available at the mall are presented as a sequence under the mapping Shops.

Lets take just the Shops section and add the floor location for each brand.
```
 Shops:
    - brand: Hamlets
      floor: 1st Floor
    - brand: H&M
      floor: Ground Floor
    - brand: Marks & Spencer
      floor: Ground Floor
```
Lets break it down:
- This is mapping of sequence, where the sequence is a sequence of mappings.
- The top level key is Shops whose value is a sequence.
- Each item in the sequence is a group of mappings.

This is where I used to get confused. Lets take the item in the first sequence.
```
brand: Hamlets
floor: 1st Floor
```

This is not a sequence. This is two set of mappings. 

Alternately, we can write each shop as nested mapping.
```
 Shops:
    - Hamleys:
        floor: 1st Floor
    - H&M:
        floor: Ground Floor
    - Marks & Spencer:
        floor: Ground Floor
```

## Document
A YAML file can contain multiple documents. If a file has more than one document, they be should placed within the the start (---) and end(...) markers. 

Example:
```
---
Shops:
  - Hamleys:
      floor: 1st Floor
  - H&M:
      floor: Ground Floor
  - Marks & Spencer:
      floor: Ground Floor
...
---
year: 2025
month: October
day: Friday
date: 24
...
```

When you have one marker, start or end, the other one is optional.
```
---
Shops:
  - Hamleys:
      floor: 1st Floor
  - H&M:
      floor: Ground Floor
  - Marks & Spencer:
      floor: Ground Floor

---
year: 2025
month: October
day: Friday
date: 24

```
```
Shops:
  - Hamleys:
      floor: 1st Floor
  - H&M:
      floor: Ground Floor
  - Marks & Spencer:
      floor: Ground Floor

...
year: 2025
month: October
day: Friday
date: 24
...
```

It is preferred to use the start marker. 

Examples of uses cases:
- Kubernetes deployment and it's associated service definition in one file.
- When streaming over the network, the receiver needs to know where the document ends.  

## Multi-line strings
There is actually another way to write the address of the mall.
```
address: 1 MG Road, Bangalore, Karnataka 560008,Opposite Vivanta by Taj
```

### Literal Block Scalar
Address of the mall.
```
address: |
  1 MG Road
  Bangalore
  Karnataka 560008
  Opposite Vivanta by Taj
```

The address is broken down into 4 lines. Linebreak and indent are preserved. So these are actual 4 lines.

### Folded Block Scalar
```
address: >
  1 MG Road
  Bangalore
  Karnataka 560008
  Opposite Vivanta by Taj
```

Line break is not preserved. Consecutive lines at the same indent level will be folded with a space.

The above address in folded style will be treated as a single line.
```
1 MG Road Bangalore Karnataka 560008 Opposite Vivanta by Taj
```

This can be useful to split up a long command into multiple lines for readability. In bash, we use  `\` to write a multi-line command.

```bash
sudo apt install -y fontconfig openjdk-21-jre \
git ansible ngrok nginx \
tomcat haproxy
```

In YAML, this can be written as
```
command: >
  sudo apt install -y 
  fontconfig openjdk-21-jre 
  git ansible ngrok nginx 
  tomcat haproxy
```
and it will treated as single line of commands when parsed. To add a line break, we need an empty line.
```
address: >
  1 MG Road
  Bangalore

  Karnataka 560008
  Opposite Vivanta by Taj
```

## Anchor, Alias
In our job role documents, lets add the department and the cost center.
```
job_roles:
  - DevOps:
      department: Engineering
      cost_center: 110023
  - DevSecOps:
      department: Engineering
      cost_center: 110023
  - MLOPs:
      department: Engineering
      cost_center: 110023
```

The department and the cost center are the same for all roles. We can avoid this repetition using anchor(&) and alias(*).

```
job_roles:
  - DevOps: &details
      department: Engineering
      cost_center: 110023
  - DevSecOps: *details
  - MLOPs: *details
```

## Flow type
The indented style we have seen so far is called  Block Style. YAML also supports FLow Style which is similar to JSON.

In Flow style, our job roles can be written as:
```
{job_roles: [DevOps, DevSecOPs, MLOPs]}
```
- Quotations are not required but it will work.
- Mapping uses curly braces
- Sequence uses square brackets

The brackets and the content can be on different lines but they must be indented.

```
job_roles: [
  DevOps, DevSecOPs, MLOPs
  ]
```
```
job_roles: [
  DevOps, DevSecOPs,
  MLOPs
  ]
```
We can improve the readability of our expanded job roles using a mix of the two styles.

```
job_roles:
  - - DevOps
    - DevSecOps
    - MLOPs
  - - Full stack Dev
    - Frontend Dev
    - Backend Dev
  - - Project Manager
    - Business Analyst
    - Program Manager
```

```
job_roles:
  - [DevOps, DevOps, MLOps]
  - [Full stack Dev, Frontend Dev, Backend Dev]
  - [Project Manager, Business Analyst, Program Manager]
```
## Update YAML file with yq
There is a tool called jq for querying and manipulating JSON. The [home page of jq](https://jqlang.org/) says:
>jq is like sed for JSON data - you can use it to slice and filter and map and transform structured data with the same ease that sed, awk, grep and friends let you play with text.

[yq](https://github.com/mikefarah/yq) is a similar tool for YAML. Let us look at a few things we can do with yq.

- I have save our job roles in a file.
    ```
    cat job_roles.yaml
    job_roles:
      - DevOps:
          department: Engineering
          cost_center: 110023
      - DevSecOps:
          department: Engineering
          cost_center: 110023
      - MLOPs:
          department: Engineering
          cost_center: 110023
    ```

- Extract all job roles
    ```
    yq '.job_roles' job_roles.yaml
      - DevOps:
          department: Engineering
          cost_center: 110023
      - DevSecOps:
          department: Engineering
          cost_center: 110023
      - MLOPs:
          department: Engineering
          cost_center: 110023
    ```
- Extract DevOps
    ```
    yq '.job_roles[0]' job_roles.yaml
    DevOps:
    department: Engineering
    cost_center: 110023
    ```
- Extract the cost center of DevSecOps
    ```
    yq '.job_roles[1].DevSecOps.cost_center' job_roles.yaml
    110023
    ```
- Update the cost center of MLOps
    ```
    yq -i '.job_roles[2].MLOPs.cost_center = 120013' job_roles.yaml
    yq '.job_roles[2].MLOPs.cost_center' job_roles.yaml
    120013
    ```
    This can be useful to update YAML files non-interactively, from a script for example.

- Convert YAML to JSON
    ```
    yq -o json job_roles.yaml
    ```
- Convert JSON to YAML
    ```
    yq -Poy job_roles.json
    ```

## Learn YAML from it's site
The home page of the official YAML website [yaml.org](https://yaml.org/) is creatively written in YAML. If you can understand the home page, you already know YAML! 

- The `%YAML 1.2` directive at the top means it follows YAML Spec 1.2.

- It is followed by the document start marker `---`. This is also used to explicitly state it is a YAML document.

- After this, it is followed by 5 top level nodes which are mappings.
  - YAML
  - What It Is
  - YAML Resources
  - YAML Framework and Tools
  - Related Projects

1. YAML
  - This has a single scalar value. 

1. What It Is
  - It has a scalar value.
  - It is a multi-line sentence that will be treated as a single line. 

1. YAML Resources 
  - This is a mapping of mappings with further nested items.

1. YAML Frameworks and Tools
  - This is also a mapping of mappings where the child keys have sequence as values.

1. Related Projects
  - This is a mapping whose value is a sequence.